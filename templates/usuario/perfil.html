{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="profile-header">
    <div class="profile-info">
        {% if usuario.fotoDePerfil %}
            <img src="{{ usuario.fotoDePerfil.url }}" alt="Foto de perfil" class="profile-pic">
        {% endif %}
        <h1>{{ usuario.nombreCompleto }}</h1>
        <p class="username">@{{ usuario.username }}</p>
        {% if usuario.bio %}
            <p class="bio">{{ usuario.bio }}</p>
        {% endif %}
        
        {% if user.is_authenticated and user != usuario %}
            <div class="follow-button">
                {% if is_following %}
                    <form action="{% url 'unfollow_user' usuario.username %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-secondary">Dejar de seguir</button>
                    </form>
                {% else %}
                    <form action="{% url 'follow_user' usuario.username %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-primary">Seguir</button>
                    </form>
                {% endif %}
            </div>
        {% endif %}
    </div>

    <div class="filters">
        <div class="filter-section">
            <h3>Etiquetas</h3>
            <div class="tags">
                <a href="?{% if coleccion_seleccionada %}coleccion={{ coleccion_seleccionada }}&{% endif %}" 
                   class="tag {% if not etiqueta_seleccionada %}active{% endif %}">
                    Todas
                </a>
                {% for etiqueta in etiquetas %}
                    <a href="?etiqueta={{ etiqueta.nombre }}{% if coleccion_seleccionada %}&coleccion={{ coleccion_seleccionada }}{% endif %}" 
                       class="tag {% if etiqueta.nombre == etiqueta_seleccionada %}active{% endif %}">
                        {{ etiqueta.nombre }}
                    </a>
                {% endfor %}
            </div>
        </div>

        <div class="filter-section">
            <h3>Colecciones</h3>
            <div class="collections">
                <a href="?{% if etiqueta_seleccionada %}etiqueta={{ etiqueta_seleccionada }}&{% endif %}" 
                   class="collection {% if not coleccion_seleccionada %}active{% endif %}">
                    Todas
                </a>
                {% for coleccion in colecciones %}
                    <a href="?coleccion={{ coleccion.titulo }}{% if etiqueta_seleccionada %}&etiqueta={{ etiqueta_seleccionada }}{% endif %}" 
                       class="collection {% if coleccion.titulo == coleccion_seleccionada %}active{% endif %}">
                        {{ coleccion.titulo }}
                    </a>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<div class="photos-grid">
    {% for foto in fotos %}
        {% include 'foto_card.html' %}
    {% empty %}
        <p>No hay fotos para mostrar.</p>
    {% endfor %}
</div>
{% endblock %}